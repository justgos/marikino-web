{"version":3,"file":"static/webpack/static/development/pages/index.js.6d2ff01aac95526c3ad9.hot-update.js","sources":["webpack:///./pages/index.tsx"],"sourcesContent":["import { useMemo, useState, useEffect } from 'react';\nimport Link from 'next/link';\nimport classNames from 'classnames';\nimport { jsx, css } from '@emotion/core';\n\nimport './index.scss';\nimport Header from '../components/Header';\n\nconst IndexPage = () => {\n  const [ eyeState, setEyeState ] = useState({\n    left: false,\n    right: false,\n    _: 1.0 as number,\n  });\n  function updateAccel(x? : number, y? : number, dx? : number, dy? : number, dz? : number) {\n    if(x == null || y == null || dx == null || dy == null)\n      return;\n    \n    const sumThreshold = 1.2;\n    const newEyeState = { ...eyeState, _: 1.0 };\n    if(Math.abs(dx) > Math.abs(dy) && dx > sumThreshold && (!eyeState.left || eyeState.right)) {\n      // console.log('updateAccel left', dx, dy)\n      newEyeState.left = true;\n      newEyeState.right = false;\n    }\n    if(Math.abs(dx) > Math.abs(dy) && dx < -sumThreshold && (eyeState.left || !eyeState.right)) {\n      // console.log('updateAccel right', dx, dy)\n      newEyeState.left = false;\n      newEyeState.right = true;\n    }\n\n    if(dy < -sumThreshold && (!eyeState.left || !eyeState.right)) {\n      // console.log('updateAccel up', dx, dy)\n      newEyeState.left = true;\n      newEyeState.right = true;\n    }\n    if((dy > sumThreshold)) {  //  || (dy > -sumThreshold && Math.abs(x) < threshold)  //  && (eyeState.left || eyeState.right)\n      // console.log('updateAccel down', dx, dy)\n      newEyeState.left = false;\n      newEyeState.right = false;\n      newEyeState._ = 2.0;\n    }\n\n    if(newEyeState.left !== eyeState.left || newEyeState.right !== eyeState.right || newEyeState._ !== eyeState._)\n      setEyeState(newEyeState);\n  }\n\n  const accelState = useMemo(() => ({\n    landscape : false,\n    x: 0,\n    y: 0,\n    z: 0,\n    dx: 0,\n    dy: 0,\n    dz: 0,\n    dxSum: 0,\n    dySum: 0,\n  }), []);\n  const handleOrientation = (event : any) => {\n    const { orientation } = window\n    accelState.landscape = orientation === 90 || orientation === -90;\n  }\n  const handleAcceleration = (event : DeviceMotionEvent) => {\n    const { landscape } = accelState\n    const { useGravity, multiplier } = { useGravity: true, multiplier: 1.0 };\n    const acceleration = useGravity ? event.accelerationIncludingGravity : event.acceleration\n    const rotation = event.rotationRate || null\n    const { x, y, z } = acceleration || { x: 0, y: 0, z: 0 };\n    // console.log('handleAcceleration', x, y, z)\n    if(x == null || y == null || z == null)\n      return;\n\n    accelState.dx = (landscape ? y : x) * multiplier - accelState.x;\n    accelState.dy = (landscape ? x : y) * multiplier - accelState.y;\n    accelState.dz = z * multiplier - accelState.x;\n    accelState.x = (landscape ? y : x) * multiplier;\n    accelState.y = (landscape ? x : y) * multiplier;\n    accelState.z = z * multiplier;\n    accelState.dxSum = accelState.dxSum * 0.9 + accelState.dx;\n    accelState.dySum = accelState.dySum * 0.9 + accelState.dy;\n    updateAccel(accelState.x, accelState.y, accelState.dxSum, accelState.dySum, accelState.dz);\n  }\n\n  useEffect(() => {\n    window.addEventListener('devicemotion', handleAcceleration)\n    window.addEventListener('orientationchange', handleOrientation)\n\n    return () => {\n      window.removeEventListener('devicemotion', handleAcceleration);\n      window.removeEventListener('orientationchange', handleOrientation);\n    };\n  }, []);\n  // console.log('eyeState', eyeState)\n\n  console.log('window.DeviceMotionEvent', window.DeviceMotionEvent)\n  \n  return (\n    <>\n      <Header />\n      <div className=\"index-container\">\n        <div className=\"eye-container\">\n          <Link href=\"/me\"><a>\n            <div className=\"logo\" />\n          </a></Link>\n\n          <Link href=\"/raster\"><a>\n            <div\n              className={classNames(\"eye-raster\", { active: eyeState.left })}\n            >\n              <div\n                className=\"hint\"\n                css={css`\n                  display: none;\n\n                  @media (max-width: 1200px) {\n                    display: ${(typeof window !== 'undefined' && window.DeviceMotionEvent) ? 'none' : 'block'};\n                  }\n                `}\n              >\n                raster\n              </div>\n            </div>\n          </a></Link>\n          <Link href=\"/vector\"><a>\n            <div\n              className={classNames(\"eye-vector\", { active: eyeState.right })}\n            >\n              <div\n                className=\"hint\"\n                css={css`\n                  display: none;\n\n                  @media (max-width: 1200px) {\n                    display: ${(typeof window !== 'undefined' && window.DeviceMotionEvent) ? 'none' : 'block'};\n                  }\n                `}\n              >\n                vector\n              </div>\n            </div>\n          </a></Link>\n        </div>\n      </div>\n    </>\n  );\n};\n\nexport default IndexPage;\n"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAAA;AACA;AACA;AACA;AAEA;AACA;;;AAEA;AAAA;AAEA;AACA;AACA;AAHA;AADA;AAAA;AACA;AAKA;AACA;AAGA;AACA;AAAA;AAAA;AAAA;AACA;AAAA;AACA;AACA;AACA;AACA;AACA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAAA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AATA;AAAA;AACA;AAUA;AAAA;AAAA;AAEA;AACA;AACA;AAAA;AAAA;AAAA;AAEA;AAAA;AAAA;AAFA;AAAA;AAGA;AACA;AACA;AALA;AAKA;AAAA;AAAA;AAAA;AALA;AAAA;AAAA;AACA;AACA;AAKA;AAGA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AAEA;AAEA;AAEA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAGA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAEA;AAAA;AAAA;AADA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAIA;AACA;AAAA;AACA;AADA;AAAA;AAFA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAcA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAEA;AAAA;AAAA;AADA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAIA;AACA;AAAA;AACA;AADA;AAAA;AAFA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAkBA;AACA;AACA;;;;A","sourceRoot":""}